<div class="container-fluid animated fadeIn">
    <div class="card shadow-sm">
      <div class="card-header">
        <div class="row justify-content-between align-items-center">
          <div class="col-auto">
            <h3 class="mb-0">Popup Form</h3>
          </div>
          <div class="col-auto">
            <button type="button" class="btn btn-danger" (click)="goBack()">
              <i class="fa fa-arrow-left me-1" aria-hidden="true"></i>
              Back
            </button>
          </div>
        </div>
      </div>
      <div class="card-body">
        <form [formGroup]="inAppAdModalForm" class="form-horizontal">
          <div class="row">
            <div class="form-group">
              <label>Title</label>
              <span class="text-danger">*</span>
              <div class="input-group input-group-alternative">
                <input type="text" class="form-control" formControlName="title" placeholder="Enter Title" />
              </div>
              <div class="text-left" *ngFor="let error of errorMessages.title">
                <ng-container *ngIf="form.title.hasError(error.type) && (form.title.dirty || form.title.touched)">
                  <small class="error-message">{{error.message}}</small>
                </ng-container>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="col-12" *ngIf="!isCategory">
              <div class="form-group">
                <label>Business</label>
                <ng-select class="custom" formControlName="shopId" [editableSearchTerm]="true"
                  (scrollToEnd)="onScrollShop()" [virtualScroll]="true" (change)="setShop($event)">
                  <ng-option *ngFor="let item of shopData" [value]="item?.shopDetails?._id">
                    {{ item?.shopDetails?.shopName | uppercase }}
                  </ng-option>
                </ng-select>
              </div>
            </div>


          </div>


          <div class="form-row">
            <div class="col-6">
              <div class="form-group">
                <label>Start date</label>
                <span class="text-danger">*</span>
                <div class="input-group">
                  <input class="form-control" placeholder="dd-mm-yyyy" name="dp1" formControlName="startDate"
                    ngbDatepicker #d1="ngbDatepicker" [autoClose]="true" outsideDays="hidden" [minDate]="todayDate">
                  <div class="input-group-append">
                    <button class="btn btn-outline-primary" (click)="d1.toggle()" type="button"><i class="fa fa-calendar"
                        aria-hidden="true"></i></button>
                  </div>
                </div>
                <div class="text-left" *ngFor="let error of errorMessages.startDate">
                  <ng-container
                    *ngIf="form.startDate.hasError(error.type) && (form.startDate.dirty || form.startDate.touched)">
                    <small class="error-message">{{error.message}}</small>
                  </ng-container>
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="form-group pl-4">
                <label>End date</label>
                <span class="text-danger">*</span>
                <div class="input-group">
                  <input class="form-control" placeholder="dd-mm-yyyy" name="dp2" formControlName="endDate" ngbDatepicker
                    #d2="ngbDatepicker" outsideDays="hidden" [autoClose]="true" [minDate]="form.startDate.value">
                  <div class="input-group-append">
                    <button class="btn btn-outline-primary" (click)="d2.toggle()" type="button"><i class="fa fa-calendar"
                        aria-hidden="true"></i></button>
                  </div>
                </div>
                <div class="text-left" *ngFor="let error of errorMessages.endDate">
                  <ng-container *ngIf="form.endDate.hasError(error.type) && (form.endDate.dirty || form.endDate.touched)">
                    <small class="error-message">{{error.message}}</small>
                  </ng-container>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12">
              <div class="row">
                <div class="col-md-9 pt-3" *ngIf="!form.image.value">
                  <div class="form-group satFat-logoBody">
                    <label for="Advertise Image">Upload Image (image should be width:360px & height:360px)
                      <span class="text-danger">*</span>
                    </label>
                    <ngx-file-drop class="ngx-fileDropBody" dropZoneClassName="satFat-dropZoneBody imgBorderYes"
                      contentClassName="satFat-contentBody" (onFileDrop)="dropped($event)" (onFileOver)="fileOver($event)"
                      (onFileLeave)="fileLeave($event)" accept="image/jpeg, image/png, video/mp4, image/gif">
                      <ng-template ngx-file-drop-content-tmp let-openFileSelector="openFileSelector">
                        <div class="align-self-center"></div>

                        <div class="imgNone d-flex flex-column text-center">
                          <div class="cloudIcon">
                            <i class="fa fa-cloud-upload"></i>
                          </div>
                          Upload File (Drag & Drop)
                          <div class="text-dark">OR</div>
                          <button type="button" (click)="openFileSelector()">
                            Browse File
                          </button>
                        </div>
                      </ng-template>
                    </ngx-file-drop>
                  </div>
                  <div class="text-left" *ngFor="let error of errorMessages.image">
                    <ng-container *ngIf="form.image.hasError(error.type) && (form.image.dirty || form.image.touched)">
                      <small class="error-message">{{error.message}}</small>
                    </ng-container>
                  </div>
                </div>

                <div class="col-md-3 text-center align-self-center" *ngIf="form.image.value && contentType!='.mp4'">
                  <i (click)="removeUploadedImage()" class="delete-badge fa fa-trash shadow-sm"></i>
                  <img [src]="form.image.value" class="img-fluid img-size" />
                </div>
                <div class="col-md-3 text-center align-self-center" *ngIf="form.image.value && contentType=='.mp4'">
                  <i (click)="removeUploadedImage()" class="delete-badge fa fa-trash shadow-sm"></i>
                  <video class="img-fluid img-size" controls autoplay="true" type="video/mp4">
                    <source [src]="form.image.value" type='video/mp4' />
                  </video>
                </div>
              </div>
            </div>
          </div>

        </form>
        <div class="mb-2 text-center">
          <button type="button" class="btn btn-success" *ngIf="!this.inAppAdModalForm.value.id" (click)="create()">
            Save
          </button>
          <button type="button" class="btn btn-success" *ngIf="this.inAppAdModalForm.value.id" (click)="update()">
            Update
          </button>
          <button type="button" class="btn btn-outline-danger mx-2" (click)="goBack()">
            Cancel
          </button>
        </div>
      </div>
    </div>
  </div>